"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[770],{66770:function(e,t,n){n.r(t),n.d(t,{default:function(){return u}});var i=n(47901),s=n.n(i),r=n(15011),o=n(77191),a=n.n(o),c=function(e,t,n,i){return new(n||(n=Promise))(function(s,r){function o(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?s(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,a)}c((i=i.apply(e,t||[])).next())})};class u extends s(){constructor(e,t){if(super(),this._network=t,this._publicKey=null,this._popup=null,this._handlerAdded=!1,this._nextRequestId=1,this._autoApprove=!1,this._responsePromises=new Map,this.handleMessage=e=>{var t;if(this._injectedProvider&&e.source===window||e.origin===(null===(t=this._providerUrl)||void 0===t?void 0:t.origin)&&e.source===this._popup){if("connected"===e.data.method){let t=new r.nh(e.data.params.publicKey);this._publicKey&&this._publicKey.equals(t)||(this._publicKey&&!this._publicKey.equals(t)&&this.handleDisconnect(),this._publicKey=t,this._autoApprove=!!e.data.params.autoApprove,this.emit("connect",this._publicKey))}else if("disconnected"===e.data.method)this.handleDisconnect();else if(e.data.result||e.data.error){let t=this._responsePromises.get(e.data.id);if(t){let[n,i]=t;e.data.result?n(e.data.result):i(Error(e.data.error))}}}},this._beforeUnload=()=>{this.disconnect()},"object"==typeof e&&null!==e&&"postMessage"in e&&"function"==typeof e.postMessage)this._injectedProvider=e;else if("string"==typeof e)this._providerUrl=new URL(e),this._providerUrl.hash=new URLSearchParams({origin:window.location.origin,network:this._network}).toString();else throw Error("provider parameter must be an injected provider or a URL string.")}handleConnect(){var e;return(this._handlerAdded||(this._handlerAdded=!0,window.addEventListener("message",this.handleMessage),window.addEventListener("beforeunload",this._beforeUnload)),this._injectedProvider)?new Promise(e=>{this.sendRequest("connect",{}),e()}):(window.name="parent",this._popup=window.open(null===(e=this._providerUrl)||void 0===e?void 0:e.toString(),"_blank","location,resizable,width=460,height=675"),new Promise(e=>{this.once("connect",e)}))}handleDisconnect(){this._handlerAdded&&(this._handlerAdded=!1,window.removeEventListener("message",this.handleMessage),window.removeEventListener("beforeunload",this._beforeUnload)),this._publicKey&&(this._publicKey=null,this.emit("disconnect")),this._responsePromises.forEach(([,e],t)=>{this._responsePromises.delete(t),e(Error("Wallet disconnected"))})}sendRequest(e,t){return c(this,void 0,void 0,function*(){if("connect"!==e&&!this.connected)throw Error("Wallet not connected");let n=this._nextRequestId;return++this._nextRequestId,new Promise((i,s)=>{var r,o,a,c;this._responsePromises.set(n,[i,s]),this._injectedProvider?this._injectedProvider.postMessage({jsonrpc:"2.0",id:n,method:e,params:Object.assign({network:this._network},t)}):(null===(r=this._popup)||void 0===r||r.postMessage({jsonrpc:"2.0",id:n,method:e,params:t},null!==(a=null===(o=this._providerUrl)||void 0===o?void 0:o.origin)&&void 0!==a?a:""),this.autoApprove||null===(c=this._popup)||void 0===c||c.focus())})})}get publicKey(){return this._publicKey}get connected(){return null!==this._publicKey}get autoApprove(){return this._autoApprove}connect(){return c(this,void 0,void 0,function*(){this._popup&&this._popup.close(),yield this.handleConnect()})}disconnect(){return c(this,void 0,void 0,function*(){this._injectedProvider&&(yield this.sendRequest("disconnect",{})),this._popup&&this._popup.close(),this.handleDisconnect()})}sign(e,t){return c(this,void 0,void 0,function*(){if(!(e instanceof Uint8Array))throw Error("Data must be an instance of Uint8Array");let n=yield this.sendRequest("sign",{data:e,display:t}),i=a().decode(n.signature),s=new r.nh(n.publicKey);return{signature:i,publicKey:s}})}signTransaction(e){return c(this,void 0,void 0,function*(){let t=yield this.sendRequest("signTransaction",{message:a().encode(e.serializeMessage())}),n=a().decode(t.signature),i=new r.nh(t.publicKey);return e.addSignature(i,n),e})}signAllTransactions(e){return c(this,void 0,void 0,function*(){let t=yield this.sendRequest("signAllTransactions",{messages:e.map(e=>a().encode(e.serializeMessage()))}),n=t.signatures.map(e=>a().decode(e)),i=new r.nh(t.publicKey);return e=e.map((e,t)=>(e.addSignature(i,n[t]),e))})}diffieHellman(e){return c(this,void 0,void 0,function*(){if(!(e instanceof Uint8Array))throw Error("Data must be an instance of Uint8Array");let t=yield this.sendRequest("diffieHellman",{publicKey:e});return t})}}},47901:function(e){var t=Object.prototype.hasOwnProperty,n="~";function i(){}function s(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function r(e,t,i,r,o){if("function"!=typeof i)throw TypeError("The listener must be a function");var a=new s(i,r||e,o),c=n?n+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function o(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function a(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(n=!1)),a.prototype.eventNames=function(){var e,i,s=[];if(0===this._eventsCount)return s;for(i in e=this._events)t.call(e,i)&&s.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?s.concat(Object.getOwnPropertySymbols(e)):s},a.prototype.listeners=function(e){var t=n?n+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var s=0,r=i.length,o=Array(r);s<r;s++)o[s]=i[s].fn;return o},a.prototype.listenerCount=function(e){var t=n?n+e:e,i=this._events[t];return i?i.fn?1:i.length:0},a.prototype.emit=function(e,t,i,s,r,o){var a=n?n+e:e;if(!this._events[a])return!1;var c,u,h=this._events[a],d=arguments.length;if(h.fn){switch(h.once&&this.removeListener(e,h.fn,void 0,!0),d){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,t),!0;case 3:return h.fn.call(h.context,t,i),!0;case 4:return h.fn.call(h.context,t,i,s),!0;case 5:return h.fn.call(h.context,t,i,s,r),!0;case 6:return h.fn.call(h.context,t,i,s,r,o),!0}for(u=1,c=Array(d-1);u<d;u++)c[u-1]=arguments[u];h.fn.apply(h.context,c)}else{var l,p=h.length;for(u=0;u<p;u++)switch(h[u].once&&this.removeListener(e,h[u].fn,void 0,!0),d){case 1:h[u].fn.call(h[u].context);break;case 2:h[u].fn.call(h[u].context,t);break;case 3:h[u].fn.call(h[u].context,t,i);break;case 4:h[u].fn.call(h[u].context,t,i,s);break;default:if(!c)for(l=1,c=Array(d-1);l<d;l++)c[l-1]=arguments[l];h[u].fn.apply(h[u].context,c)}}return!0},a.prototype.on=function(e,t,n){return r(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return r(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,i,s){var r=n?n+e:e;if(!this._events[r])return this;if(!t)return o(this,r),this;var a=this._events[r];if(a.fn)a.fn!==t||s&&!a.once||i&&a.context!==i||o(this,r);else{for(var c=0,u=[],h=a.length;c<h;c++)(a[c].fn!==t||s&&!a[c].once||i&&a[c].context!==i)&&u.push(a[c]);u.length?this._events[r]=1===u.length?u[0]:u:o(this,r)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&o(this,t)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a}}]);